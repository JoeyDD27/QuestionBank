# QuestionBank é¡¹ç›®è§„èŒƒ

> **âš ï¸ å¼ºåˆ¶è¦æ±‚**: ä»¥ä¸‹æƒ…å†µ**å¿…é¡»**æ£€æŸ¥å¹¶æ›´æ–° CLAUDE.mdï¼š
> 1. æ¯æ¬¡ `git commit` ä¹‹å‰
> 2. ç”¨æˆ·è¯´ "exit" / "quit" / "ç»“æŸ" / "bye" ç­‰é€€å‡ºæ„å›¾æ—¶
> 3. é•¿æ—¶é—´å·¥ä½œåï¼ˆå³ä½¿æœª commitï¼‰
>
> **æ£€æŸ¥æ¸…å•**:
> - [ ] å½“å‰çŠ¶æ€ï¼ˆç« èŠ‚è¿›åº¦ã€æ•°æ®åº“ç»Ÿè®¡ï¼‰æ˜¯å¦éœ€è¦æ›´æ–°ï¼Ÿ
> - [ ] æ˜¯å¦æœ‰æ–°çš„è¸©å‘è®°å½•éœ€è¦è¡¥å……ï¼Ÿ

## é¡¹ç›®æ¦‚è¿°

**QuestionBank** æ˜¯ IB/IGCSE æ•°å­¦é¢˜åº“ç³»ç»Ÿã€‚ä» Word æ–‡æ¡£å›¾ç‰‡æå–æ•°å­¦é¢˜ç›®ï¼Œå­˜å…¥ Supabaseï¼Œé€šè¿‡ Web å±•ç¤ºã€‚

## ç”¨æˆ·ç”»åƒä¸åœºæ™¯

### ç›®æ ‡ç”¨æˆ·
**IB/IGCSE æ•°å­¦è€å¸ˆ**

### æ ¸å¿ƒä½¿ç”¨åœºæ™¯
1. **æŒ‰çŸ¥è¯†ç‚¹ç­›é€‰é¢˜ç›®** - è€å¸ˆæƒ³æ‰¾"è´ŸæŒ‡æ•°è¿ç®—"ç›¸å…³ç»ƒä¹ é¢˜
2. **æŒ‰é¢˜å‹/éš¾åº¦ç­›é€‰** - é€‰æ‹©é€‚åˆå­¦ç”Ÿæ°´å¹³çš„é¢˜ç›®
3. **ç”Ÿæˆç»ƒä¹ å·** - å‹¾é€‰é¢˜ç›® â†’ å¯¼å‡º PDFï¼ˆé¢˜ç›®å· + ç­”æ¡ˆå·åˆ†å¼€ï¼‰
4. **å¤‡è¯¾å‚è€ƒ** - æŸ¥çœ‹ concept å’Œ example ä½œä¸ºæ•™å­¦ç´ æ

### ç”¨æˆ·ç—›ç‚¹
- é¢˜ç›®æ•£è½åœ¨ Word æ–‡æ¡£ä¸­ï¼ŒæŸ¥æ‰¾è´¹æ—¶
- æ— æ³•æŒ‰çŸ¥è¯†ç‚¹å¿«é€Ÿå®šä½
- æ‰‹åŠ¨æ’ç‰ˆç»ƒä¹ å·ç¹ç

### äº§å“ä»·å€¼
- é¢˜ç›®ç»“æ„åŒ–ï¼Œæ”¯æŒå¤šç»´ç­›é€‰
- ä¸€é”®ç”Ÿæˆæ ¼å¼è§„èŒƒçš„ç»ƒä¹ å·
- ä¿ç•™åŸå§‹å›¾ç‰‡ä¾¿äºæ ¸å¯¹

## å¼€å‘é˜¶æ®µ

| é˜¶æ®µ | ç›®æ ‡ | çŠ¶æ€ |
|------|------|------|
| **é˜¶æ®µ1** | åŸºç¡€æå–ï¼šå®Œæ•´å‡†ç¡®åœ°ä»å›¾ç‰‡æå–å†…å®¹ | ğŸ”„ è¿›è¡Œä¸­ |
| **é˜¶æ®µ2** | ç»“æ„åŒ–ï¼šæ·»åŠ  section/topic å±‚çº§ã€åˆå¹¶ç›¸å…³ itemsã€çŸ¥è¯†ç‚¹æ ‡ç­¾ | â³ å¾…å¼€å§‹ |
| **é˜¶æ®µ3** | å‡ºå·åŠŸèƒ½ï¼šå‹¾é€‰é¢˜ç›®ã€ç”Ÿæˆ PDF | â³ å¾…å¼€å§‹ |

### çº¿ä¸Šåœ°å€

- **ç½‘ç«™**: https://web-plum-zeta-69.vercel.app
- **Supabase**: https://orfxntmcywouoqpasivm.supabase.co

### éƒ¨ç½²å‘½ä»¤

å‰ç«¯ä¿®æ”¹åéœ€æ‰‹åŠ¨éƒ¨ç½²ï¼ˆè‡ªåŠ¨éƒ¨ç½²å¤ªæ…¢ï¼‰ï¼š

```bash
cd web && vercel --prod
```

## å½“å‰çŠ¶æ€ (2026-01-19)

### ç« èŠ‚è¿›åº¦

| ç« èŠ‚ | çŠ¶æ€ | Items |
|------|------|-------|
| ch01 | âœ… å®Œæˆ | 203 |
| ch02 | âœ… å®Œæˆ | 41 |
| ch03 | âœ… å®Œæˆ | 41 |
| ch04 | âœ… å®Œæˆ | 16 |
| ch05 | âœ… å®Œæˆ | 133 |
| ch06 | âœ… å®Œæˆ | 98 |
| ch07 | âœ… å®Œæˆ | 128 |
| ch08 | âœ… å®Œæˆ | 55 |
| ch09 | âœ… å®Œæˆ | 34 |
| ch10 | âœ… å®Œæˆ | 89 |
| ch11 | âœ… å®Œæˆ | 188 |
| ch12 | âœ… å®Œæˆ | 29 |
| ch13 | âœ… å®Œæˆ | 139 |
| ch14 | âœ… å®Œæˆ | 160 |
| ch15 | âœ… å®Œæˆ | 191 |
| ch16 | âœ… å®Œæˆ | 95 |
| ch17 | âœ… å®Œæˆ | 10 |
| ch18 | âœ… å®Œæˆ | 67 |
| ch19 | âœ… å®Œæˆ | 45 |
| ch20 | âœ… å®Œæˆ | 27 |
| ch21 | âœ… å®Œæˆ | 116 |
| ch22 | âœ… å®Œæˆ | 39 |
| ch23 | âœ… å®Œæˆ | 120 |
| ch24 | âœ… å®Œæˆ | 19 |
| ch25 | âœ… å®Œæˆ | 98 |
| ch26 | âœ… å®Œæˆ | 51 |
| ch27 | âœ… å®Œæˆ | 39 |
| ch28 | âœ… å®Œæˆ | 47 |
| ch29 | âœ… å®Œæˆ | 57 |
| ch30 | âœ… å®Œæˆ | 55 |
| ch31 | âœ… å®Œæˆ | 41 |
| ch32 | âœ… å®Œæˆ | 98 |
| ch33 | âœ… å®Œæˆ | 40 |

### ğŸ‰ å…¨éƒ¨ç« èŠ‚æå–å®Œæˆï¼

### æ•°æ®åº“ç»Ÿè®¡

- **chapters**: 33 è¡Œ
- **images**: 2952 è¡Œ (å…¨éƒ¨å·²ä¸Šä¼ )
- **items**: 2609 è¡Œ (ch01-ch33 å…¨éƒ¨å®Œæˆ)
- **questions**: åŒä¸Š

### è¸©å‘è®°å½•

- **images.order_index**: 2026-01-19 æ·»åŠ è¯¥åˆ—ï¼Œå¯¼å…¥è„šæœ¬éœ€è¦æ­¤å­—æ®µæ’åºå›¾ç‰‡
- **API 100 å›¾ç‰‡é™åˆ¶**: 2026-01-19 å‘ç°ã€‚æ¯ä¸ª session ç´¯è®¡è¯»å–å›¾ç‰‡ä¸èƒ½è¶…è¿‡ 100 å¼ ï¼Œå¦åˆ™æŠ¥é”™ `Too much media: N images > 100`ã€‚å›¾ç‰‡è¯»å–åç´¯ç§¯åœ¨ context ä¸­ï¼Œå†™å®Œ JSON ä¹Ÿä¸ä¼šæ¸…é™¤ã€‚
- **Supabase 1000 row limit**: 2026-01-19 å‘ç°ã€‚é¦–é¡µç« èŠ‚ç»Ÿè®¡æŸ¥è¯¢ä½¿ç”¨ `range()` è€Œé `limit()` åˆ†é¡µè·å–æ‰€æœ‰æ•°æ®ï¼Œå¦åˆ™è¶…è¿‡ 1000 è¡Œçš„è¡¨ä¼šæ˜¾ç¤ºä¸å®Œæ•´ç»Ÿè®¡ã€‚
- **source_images é”™ä½**: 2026-01-19 å‘ç°ã€‚å­ agent æ‰¹é‡è¯»å–å›¾ç‰‡åï¼Œåœ¨å†™ JSON æ—¶å›¾ç‰‡ç¼–å·å¯¹åº”é”™è¯¯ï¼Œå¯¼è‡´ç½‘é¡µæ˜¾ç¤ºå›¾ç‰‡å’Œå†…å®¹ä¸åŒ¹é…ã€‚å·²æ›´æ–° skill å¼ºåˆ¶é€å¼ å¤„ç†ã€‚
- **\texteuro ä¸æ¸²æŸ“**: 2026-01-19 å‘ç°ã€‚KaTeX ä¸æ”¯æŒ `\texteuro` å‘½ä»¤ï¼Œç›´æ¥ç”¨ `â‚¬` ç¬¦å·ä»£æ›¿ã€‚
- **markdown æ–œä½“æ±¡æŸ“**: 2026-01-19 å‘ç°ã€‚`*text*` æ ¼å¼ä¼šåŸæ ·æ˜¾ç¤ºï¼Œä¸è¦ç”¨ markdown æ–œä½“ã€‚
- **$ ç¬¦å·å†²çª**: 2026-01-19 å‘ç°å¹¶è§£å†³ã€‚`$` åŒæ—¶ç”¨äº LaTeX æ•°å­¦å’Œè´§å¸ç¬¦å·å¯¼è‡´æ¸²æŸ“é”™è¯¯ã€‚**è§£å†³æ–¹æ¡ˆ**ï¼šæ”¹ç”¨æ—¥æ–‡åŠè§’æ‹¬å· `ï½¢...ï½£` (U+FF62/U+FF63) ä½œä¸ºæ•°å­¦åˆ†éš”ç¬¦ã€‚å¯¼å…¥è„šæœ¬ `import-chapter.cjs` è‡ªåŠ¨å°† `$...$` è½¬æ¢ä¸º `ï½¢...ï½£`ã€‚
- **\$ è½¬ä¹‰ç¬¦å·**: 2026-01-19 å‘ç°ã€‚JSON ä¸­çš„è´§å¸ç”¨ `$\$2,300$` æ ¼å¼ï¼ˆLaTeX è½¬ä¹‰ï¼‰ã€‚è½¬æ¢å‡½æ•°å¿…é¡»å…ˆæ›¿æ¢ `\$` ä¸ºå ä½ç¬¦ï¼Œå†å¤„ç† `$...$` é…å¯¹ï¼Œå¦åˆ™ä¼šé”™è¯¯åŒ¹é…ã€‚å·²ä¿®å¤ã€‚

### Skill ä¿®æ”¹è®°å½•

**2026-01-19** - å¤šæ¬¡ä¼˜åŒ– `questionbank-chapter-processor` skillï¼š

1. **Task å­ agent è‡ªåŠ¨åˆ†æ‰¹**
   - æ¯ä¸ªå­ agent ç‹¬ç«‹ contextï¼Œå›¾ç‰‡è®¡æ•°ä¸ç´¯ç§¯
   - å¤§ç« èŠ‚è‡ªåŠ¨åˆ†æ‰¹ï¼ˆæ¯æ‰¹ â‰¤80 å¼ ï¼‰ï¼Œå¹¶è¡Œå¤„ç†

2. **å¹³å‡åˆ†é…ä¼˜åŒ–**
   - æ”¹ç”¨å¹³å‡åˆ†é…ä»£æ›¿å›ºå®š 80 å¼ /æ‰¹
   - æœ€å¤š 4 ä¸ªå¹¶è¡Œ agentï¼Œæœ€å°æ‰¹æ¬¡ 30 å¼ 

3. **è‡ªåŠ¨æ‰¹æ¬¡è®¡ç®—**
   - æ”¯æŒ "ä» chN å¼€å§‹ä¸€æ‰¹" å‘½ä»¤
   - è‡ªåŠ¨ç´¯åŠ å›¾ç‰‡æ•°ï¼Œâ‰¤300 å¼ ä¸ºä¸€æ‰¹
   - å¤§ç« èŠ‚ (>150å¼ ) å•ç‹¬å¤„ç†

4. **ä¿®å¤ source_images é”™ä½** (æœ€æ–°)
   - å­ agent prompt å¼ºè°ƒé€å¼ å¤„ç†
   - æ¯è¯»ä¸€å¼ å›¾ç‰‡ç«‹å³è®°å½•ï¼Œç¡®ä¿ç¼–å·å‡†ç¡®
   - æ·»åŠ æœ€ç»ˆæ£€æŸ¥æ­¥éª¤

**Skill è·¯å¾„**: `~/.claude/skills/questionbank-chapter-processor/skill.md`

---

## é¡¹ç›®ç»“æ„

```
QuestionBank/
â”œâ”€â”€ chapter_image_ranges.json       # ç« èŠ‚å›¾ç‰‡èŒƒå›´ (ch01-ch33)
â”œâ”€â”€ extractions/                    # æå–çš„ JSON æ–‡ä»¶
â”œâ”€â”€ docx_extracted/word/media_compressed/  # æºå›¾ç‰‡
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ import-chapter.cjs          # ç« èŠ‚å¯¼å…¥è„šæœ¬
â”‚   â””â”€â”€ scan_format_issues.cjs      # æ ¼å¼æ£€æŸ¥
â”œâ”€â”€ web/                            # Next.js å‰ç«¯ (Vercel)
â””â”€â”€ .env                            # Supabase å¯†é’¥
```

## ç« èŠ‚å¤„ç†æµç¨‹

ä½¿ç”¨ `questionbank-chapter-processor` skill:

```
"æå– ch02" æˆ– "process chapter 2"
```

è‡ªåŠ¨æ‰§è¡Œ:
1. è¯»å– chapter_image_ranges.json è·å–å›¾ç‰‡èŒƒå›´
2. åˆ† part è¯»å›¾æå–å†…å®¹ â†’ JSON
3. è¿è¡Œ `node scripts/import-chapter.cjs --ch=N`
4. ä¸Šä¼ å›¾ç‰‡ + å¯¼å…¥æ•°æ®åº“

éªŒè¯: https://web-plum-zeta-69.vercel.app

---

## Schema: items_flat (æ ‡å‡†æ ¼å¼)

```json
{
  "chapter": 2,
  "part": 1,
  "images_range": "195-224",
  "items": [
    {
      "type": "example",
      "content_latex": "Example 1\n\nExpand:\n\n(a) $3(x+2)$\n\nSolutions:\n\n(a) $3x+6$",
      "source_images": ["image195.png"]
    }
  ]
}
```

### å­—æ®µè¯´æ˜

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| type | string | concept / example / exercise / definition / investigation |
| content_latex | string | å®Œæ•´å†…å®¹ï¼ŒLaTeX æ ¼å¼ |
| source_images | string[] | æºå›¾ç‰‡æ–‡ä»¶å |

### é¢˜å·æ ¼å¼

| Level | Format | Example |
|-------|--------|---------|
| Main | `1.` | `1. Simplify:` |
| Sub | `(a)` | `(a) $x^2$` |
| Sub-sub | `(i)` | `(i) $\frac{1}{2}$` |

---

## LaTeX è§„èŒƒ

### å…¬å¼

- è¡Œå†…: `$...$`
- æ¢è¡Œ: ç”¨ `\n`ï¼ˆJSON ä¸­çš„å®é™…æ¢è¡Œï¼‰

### å¸¸ç”¨ç¬¦å·

| ç¬¦å· | LaTeX |
|------|-------|
| Ã— | `\times` |
| Ã· | `\div` |
| åˆ†æ•° | `\frac{a}{b}` |
| æ ¹å· | `\sqrt{x}` |
| é›†åˆ | `\{1,2,3\}` |

### ç¦æ­¢

- `**markdown åŠ ç²—**` â†’ æ ¼å¼æ±¡æŸ“
- `\\n` â†’ ä¼šæ˜¾ç¤ºä¸ºå­—é¢ `\n`

---

## Supabase

- **Project ID**: `orfxntmcywouoqpasivm`
- **Tables**: chapters, images, items, questions
- **Storage**: `question-images/algebra/`

### å¯¼å…¥è„šæœ¬

```bash
node scripts/import-chapter.cjs --ch=N [options]

é€‰é¡¹:
  --clear         æ¸…é™¤å·²æœ‰æ•°æ®
  --images-only   ä»…ä¸Šä¼ å›¾ç‰‡
  --data-only     ä»…å¯¼å…¥æ•°æ®
  --dry-run       é¢„è§ˆæ¨¡å¼
```

ä» `.env` è¯»å– `SUPABASE_ANON_KEY`ã€‚

---

## è´¨é‡æ£€æŸ¥

```bash
node scripts/scan_format_issues.cjs
```

æ£€æŸ¥é¡¹:
- JSON è¯­æ³•
- æ˜Ÿå·æ±¡æŸ“ (`**...**`)
- å†…å®¹å®Œæ•´æ€§

### å¸¸è§é”™è¯¯

| é”™è¯¯ | ä¿®å¤ |
|------|------|
| `[(-2, 1)]` | `[[-2, 1]]` |
| å°¾éšé€—å· | åˆ é™¤ |
| `**text**` | `text` |

---

## Agent Guidelines

- **Language**: ä½¿ç”¨ä¸­æ–‡äº¤æµ
- **Plan First**: å¤æ‚ä»»åŠ¡å…ˆæå‡ºè®¡åˆ’
- **Skill ä¼˜å…ˆ**: ç« èŠ‚å¤„ç†ä½¿ç”¨ `questionbank-chapter-processor` skill

### ç”¨æˆ·åå¥½

- æå–å®Œæˆåè‡ªåŠ¨è¿è¡Œå¯¼å…¥è„šæœ¬
- æ¯ä¸ª session ç»“æŸå‰æ›´æ–° CLAUDE.md
